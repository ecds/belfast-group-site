{% extends 'site_base.html' %}
{% load static %}

{% block page-subtitle %} | Members | {{ person.fullname }}{% endblock %}

{% block head-extras %}
{% endblock %}

{% block content %}
<h1>{{ person.name }}</h1>

{# name = {{ person.name }}<br/> #}
{# fullname = {{ person.fullname }}<br/> #}
{# lastname {{ person.lastname}}<br/> #}
{# firstname {{ person.firstname}}<br/> #}
{# short id {{ person.short_id }}<br/> #}

{% if person.rdfinfo.occupation %}
<p><b>Occupation:</b> {{ person.rdfinfo.occupation|join:', ' }}</p>
{% endif %}

{% if person.rdfinfo.locations %}
<p><b>Locations:</b>
    {# for now, link to outside URI location; eventually may want in-site links #}
  {% for loc in person.rdfinfo.locations %}
  <a href="{{ loc.identifier }}">{{ loc }}</a>{% if not forloop.last %}; {% else %}.{% endif %}
  {% endfor %}
  </p>
{% endif %}

{% if person.rdfinfo.birthdate %}
<p>Born {{ person.rdfinfo.birthdate }}
    {% if person.rdfinfo.birthplace %}
    in <a href="{{ person.rdfinfo.birthplace.identifier }}">{{ person.rdfinfo.birthplace }}</a>{% endif %}.</p>
{% endif %}

{% if person.rdfinfo.description %}
 <p class="description">{{ person.rdfinfo.description }}
    <small><i>(MARBL)</i></small> {# should be safe to assume for now ... #}
    {# TODO: should really link to the findingaids where the description comes from #}
 </p>
{% endif %}

{% if person.rdfinfo.dbpedia_description %}
 <p>{{ person.rdfinfo.dbpedia_description }}
    <small><i>({% if person.rdfinfo.wikipedia_url %}<a href="{{ person.rdfinfo.wikipedia_url }}">Wikipedia</a>{% else %}Wikipedia{% endif %})</i></small></p>
{% endif %}

<ul class="nav nav-tabs" id="vizTab">
  <li class="active"><a href="#connections">Connections</a></li>
  <li><a href="#graph">Network Graph</a></li>
  {% if groupsheets %}
    <li><a href="#groupsheets">Group Sheets</a></li>
  {% endif %}
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="connections">

  {% if person.rdfinfo.connected_people %}
    <h4>People</h4>
    <ul>
    {% for conn, rel in person.rdfinfo.connected_people.iteritems %}
        <li>{{ conn.fullname }}
            <small>&lt;{{ conn.identifier }}&gt;</small>
            {% if rel %} - {{ rel|join:', '}}{% endif %}
        </li>
    {% endfor %}
    </ul>
  {% endif %}

  {% if person.rdfinfo.connected_organizations %}
    <h4>Organizations</h4>
    <ul>
    {% for conn, rel in person.rdfinfo.connected_organizations.iteritems %}
        <li>{{ conn.name }}
            <small>&lt;{{ conn.identifier }}&gt;</small>
            {% if rel %} - {{ rel|join:', '}}{% endif %}
        </li>
    {% endfor %}
    </ul>
  {% endif %}
  </div>

  <div class="tab-pane" id="graph">
    {% include "people/ego_graph.html" %}
  </div>

  {% if groupsheets %}
    <div class="tab-pane" id="groupsheets">
        <ul class="groupsheet-list">
            {% for doc in groupsheets %}
            <li>{% include 'groupsheets/snippets/list_groupsheet.html' with profile=True %}</li>
            {% endfor %}
        </ul>
    </div>
  {% endif %}

</div>

<script>
  $(function () {
    $('#vizTab a').click(function (e) {
      e.preventDefault();
      $(this).tab('show');
     });
  });
</script>
{% endblock %}