{% extends 'site_base.html' %}
{% load static %}

{% block page-subtitle %} | Members | {{ person.name }}{% endblock %}

{% block head-extras %}
{% endblock %}

{% block content %}
<div class="container">
{% if person.dbpedia.thumbnail %}
<div class="pull-right">
  <img src="{{ person.dbpedia.thumbnail }}"/>
  <p><small><i>image via <a href="{{ person.dbpedia.wikipedia_url }}">Wikipedia</a></i></small></p>
</div>
{% endif %}

<h1>{{ person.name }}</h1>

{% if person.occupation %}
<p><b>Occupation:</b> {{ person.occupation|join:', ' }}</p>
{% endif %}

{% if person.locations %}
<p><b>Locations:</b>
    {# for now, link to outside URI location; eventually may want in-site links #}
  {% for loc in person.locations %}
  <a href="{{ loc.identifier }}">{{ loc }}</a>{% if not forloop.last %}; {% else %}.{% endif %}
  {% endfor %}
  </p>
{% endif %}

{% if person.birthdate %}
<p>Born {{ person.birthdate }}
    {% if person.birthplace %}
    in <a href="{{ person.birthplace.identifier }}">{{ person.birthplace }}</a>{% endif %}.</p>
{% endif %}

{% if person.description %}
 <p class="description">{{ person.description }}
    <small><i>(<a href="{{ person.description_context }}">{{ person.desc_context_name }}</a>)</i></small> {# should be safe to assume for now ... #}
    {# TODO: should really link to the findingaids where the description comes from #}
 </p>
{% endif %}

{% if person.dbpedia.description %}
 <p>{{ person.dbpedia.description }}
    <small><i>({% if person.dbpedia.wikipedia_url %}<a href="{{ person.dbpedia.wikipedia_url }}">Wikipedia</a>{% else %}Wikipedia{% endif %})</i></small></p>
{% endif %}

<ul class="nav nav-tabs" id="vizTab">
  <li class="active"><a href="#connections">Connections</a></li>
  <li><a href="#graph">Network Graph</a></li>
  {% if groupsheets %}
    <li><a href="#groupsheets">Group Sheets</a></li>
  {% endif %}
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="connections">

  {% if person.connected_people %}
    <h4>People</h4>
    <ul>
    {% for conn, rel in person.connected_people.iteritems %}
        <li>{{ conn.fullname }}
            <small>&lt;{{ conn.identifier }}&gt;</small>
            {% if rel %} - {{ rel|join:', '}}{% endif %}
        </li>
    {% endfor %}
    </ul>
  {% endif %}

  {% if person.connected_organizations %}
    <h4>Organizations</h4>
    <ul>
    {% for conn, rel in person.connected_organizations.iteritems %}
        <li>{{ conn.name }}
            <small>&lt;{{ conn.identifier }}&gt;</small>
            {% if rel %} - {{ rel|join:', '}}{% endif %}
        </li>
    {% endfor %}
    </ul>
  {% endif %}
  </div>

  <div class="tab-pane" id="graph">
    {% include "people/ego_graph.html" %}
  </div>

  {% if groupsheets %}
    <div class="tab-pane" id="groupsheets">
        <ul class="groupsheet-list">
            {% for doc in groupsheets %}
            <li>{% include 'groupsheets/snippets/list_groupsheet.html' with profile=True %}</li>
            {% endfor %}
        </ul>
    </div>
  {% endif %}

</div>
</div>
<script>
  $(function () {
    $('#vizTab a').click(function (e) {
      e.preventDefault();
      $(this).tab('show');
     });
  });
</script>
{% endblock %}