{% extends 'site_base.html' %}
{% load tei %}

{% block page-subtitle %} | {{ document.title }}{% endblock %}

{% block head-extras %}
  {% if document.ark %}
    <link href="{{ document.ark }}" rel="bookmark"/>
  {% endif %}
  <link rel="alternate" type="application/rdf+xml" href="{% url 'groupsheets:view' document.id %}RDF/"/>
  {# NOTE: not strictly an alternate (may contain multiple groupsheets), but close... #}
  <link rel="alternate" type="application/xml" href="{% url 'groupsheets:xml' document.document_name %}"/>
{% endblock %}

{% block content %}

<div class="container-fluid">
    <h1 property="schema:name">{{ document.title }}</h1>
    <div class="span7">  {# NOTE: may want to shift into base site or a common template #}

    <div>
      <p><strong>Time period</strong>: {{ document.date }}</p>
      <p><strong>Poet</strong>: {{ document.author }}</p>
      {% if document.ark %}
      <p><strong>Permanent URL</strong>: <a href="{{ document.ark }}" rel="bookmark">{{ document.ark }}</a></p>
      {% endif %}
    </div>

    <div class="contents">
      <p>{{ document.toc.title }}</p>
      <ul>
{# NOTE: there is a table of contents item list, but it does not include ids #}
{# generating toc from the actual poems instead #}
        {% for poem in document.poems %}
        <li><a href="#{{ poem.id }}">{{ poem.title|default:'[untitled]' }}</a></li>
        {% endfor %}
      </ul>
    </div>

    {% for poem in document.poems %}
    {# NOTE: using ARK URL plus the poem id for poem URI #}
      <div class="poem" typeof="schema:CreativeWork" about="{{ document.ark}}#{{poem.id }}">
        <a name="{{ poem.id }}"> </a>
        {% if poem.title %}
          <h2 property="schema:name">{{ poem.title }}</h2>
        {% endif %}
        {{ poem.body|format_tei }}
        {% if poem.byline %}
          <p class="byline">{{ poem.back|format_tei }}</p>
        {% endif %}
      </div>
    {% endfor %}

    <p class="pull-right"><a href="{% url 'groupsheets:xml' document.document_name %}" rel="alternate">TEI XML</a></p>
  </div>

</div>
{% endblock %}