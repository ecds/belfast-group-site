{% extends 'site_base.html' %}
{% load tei %}

{% block page-subtitle %} | Group Sheets{% endblock %}

{% block content %}
<div class="container">

<div class="row">

  <div class="col-md-3 sidebar">
    <h4>Filter groupsheets</h4>

    {% if filters %}{# display filters currently in effect, with link to remove #}
      <ul>
        {% for label, link in filters.iteritems %}
        <li>{{ label }} <a class="small" href="{{ link }}"><span class="glyphicon glyphicon-remove-sign"></span></a></li>
        {% endfor %}
    </ul>
    {% endif %}

    <hr/>
    {% if facets.digital %}
    <p><a href="?edition=digital{{ url_suffix }}">digital editions</a> ({{ facets.digital }})</p>
    {% endif %}

    {% if facets.authors %}
    <p><b>Author</b></p>
    <ul>
        {% for f in facets.authors|dictsortreversed:"total" %}
        <li><a href="?author={{ f.author.slug }}{{ url_suffix }}">{{ f.author.lastname }}, {{ f.author.firstname }}</a> ({{ f.total }})</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if facets.sources %}
    <p><b>Source</b></p>
    <ul>
        {% for s in facets.sources|dictsortreversed:"total" %}  {# TODO: need to use short names here! #}
        <li><a href="?source={{ s.source.identifier|urlencode }}{{ url_suffix }}">{{ s.source.name }}</a> ({{ s.total }})</li>
        {# NOTE: urlencode required since collection URIs include #anchors which otherwise get lost #}
        {% endfor %}
    </ul>
    {% endif %}

  </div> {# end sidebar #}

  <div class="col-md-9">

    <h1 property="schema:name">Group Sheets</h1>

    <p>Displaying {{ documents|length }} group sheet{{ documents|pluralize }}.</p>

    <ul class="groupsheet-list">
        {% for doc in documents %}
        <li>
            {% include 'groupsheets/snippets/list_groupsheet.html' %}
        </li>
        {% endfor %}
    </ul>
  </div>

</div> {# end rows #}
</div> {# end container #}
{% endblock %}